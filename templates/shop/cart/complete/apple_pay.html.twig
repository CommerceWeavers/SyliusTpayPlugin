{% set order = get_hookable_context().resource %}
{% set payment = order.lastCartPayment()|default(null) %}

{% if payment is not null and payment.method.gatewayConfig.factoryName == 'tpay_apple_pay' %}
    {% set form = get_hookable_context().form %}
    {% set gatewayConfig = payment.method.gatewayConfig %}

    {% include '@CommerceWeaversSyliusTpayPlugin/shop/partial/apple_pay_button.html.twig' with { order, form, gatewayConfig } %}
{% endif %}
